```{r echo=FALSE, out.width="100%"}
knitr::include_graphics("bellabeat.png" , error = FALSE)
  
```

---
title: "Bellabeat Case Study"
author: "Syed Afaq Shah"
date: ' December 20, 2023'
output:
  html_document:
    toc : yes
    df_print: paged
editor_options:
  chunk_output_type: inline
  
  
  
---



## Introduction 

Bellabeat is a high-tech company that manufactures health-focused smart products.They offer different smart devices that collect data on activity, sleep, stress, and reproductive health to empower women with knowledge about their own health and habits.

The main focus of this case is to analyze smart devices fitness data and determine how it could help unlock new growth opportunities for Bellabeat. We will focus on one of Bellabeat’s products: Bellabeat app.

The Bellabeat app provides users with health data related to their activity, sleep, stress, menstrual cycle, and mindfulness habits. This data can help users better understand their current habits and make healthy decisions. The Bellabeat app connects to their line of smart wellness products

## Phase 1 : Ask


### Business Task


Analyze smart device usage data in order to gain insight into how consumers use non-Bellabeat smart devices then apply those insights on one of bellabeat products and find out how could these trends help influence Bellabeat marketing strategy?


### Stakeholders
  * Urška Sršen - Co Founder of Bellabeat & Chief Creative Officer
* Sando Mur - Co Founder of Bellabeat , A Mathematician & key member of the BellaBeat executive team
* Bellabeat Marketing Analytics team





## Phase 2 : Preparing Data

### Data Source 

This Data set  [FitBit Fitness Tracker Data](https://www.kaggle.com/datasets/arashnic/fitbit) is obtained from Kaggle through [Mobious](https://www.kaggle.com/arashnic).



### Data Organization

This Data set Contains 18 CSV Documents. Each document represents different quantitative data tracked by Fitbit. The data is considered long since each row is one time point per subject, so each subject will have data in multiple rows.Every user has a unique ID and different rows since data is tracked by day and time.
Due to the small size of sample I sorted and filtered tables creating Pivot Tables in Excel. I was able to verify attributes and observations of each table and relations between tables. Counted sample size (users) of each table and verified time length of analysis - 31 days.

### Information about our dataset
These datasets were generated by respondents to a distributed survey via Amazon Mechanical Turk between 03.12.2016-05.12.2016. Thirty eligible Fitbit users consented to the submission of personal tracker data, including minute-level output for physical activity, heart rate, and sleep monitoring. Variation between output represents use of different types of Fitbit trackers and individual tracking behaviors / preferences.

### Accessibility & Privacy 
Verifying the metadata of our dataset we can confirm it is open-source. The owner has dedicated the work to the public domain by waiving all of his or her rights to the work worldwide under copyright law, including all related and neighboring rights, to the extent allowed by law. You can copy, modify, distribute and perform the work, even for commercial purposes, all without asking permission.

### Data Credibility and Integrity
Due to the limitation of size (30 users) and not having any demographic information we could encounter a sampling bias. We are not sure if the sample is representative of the population as a whole. Another problem we would encounter is that the dataset is not current and also the time limitation of the survey (2 months long). That is why we will give our case study an operational approach.

## Phase 3 : Process the Data


### Installing and Loading Packages

The Following packages will help us solve our case study.

* tidyverse
* skimr
* janitor
* here
* ggpubr
* ggrepel


```{r chunk1, echo=TRUE, paged.print=FALSE}



library(tidyverse)
library(here)
library(skimr)
library(janitor)
library(ggpubr)
library(ggrepel)


```




### Importing the Data set

Exploring the datasets we will be using the following 3 data sets as they will help us in solving our Business task.
We have set the path to our working directory.

```{r chunk2, echo=TRUE, message=FALSE, warning=FALSE, paged.print=FALSE}
daily_activity <- read_csv("dailyActivity_merged.csv")
daily_sleep <- read_csv("sleepDay_merged.csv")
hourly_steps<- read_csv("hourlySteps_merged.csv")
```

### Preview the data sets
We will preview the following data sets and check its structure.

```{r}

head(daily_activity)
str(daily_activity)

head(daily_sleep)
str(daily_sleep)

head(hourly_steps)
str(hourly_steps)
```


### Data Cleaning and Formatting 
Now that we got to know more about our data structures we will process them to look for any errors and inconsistencies.

#### Verifying number of Users

The Minimum sample should be of 30 users but we will keep it to 24 and what is available to us.


```{r}
n_unique(daily_activity$Id)
n_unique(hourly_steps$Id)
n_unique(daily_sleep$Id)


```




#### Checking Duplicates 

Checking for Duplicates

```{r}
sum(duplicated(daily_activity))
sum(duplicated(hourly_steps))
sum(duplicated(daily_sleep))
```

0\
0\
3

#### Removing Duplicates & missing Data

We will Removie the duplicates and missing data cells

```{r}
daily_activity <- daily_activity %>%
  distinct() %>%
  drop_na()

daily_sleep <- daily_sleep %>%
  distinct() %>%
  drop_na()

hourly_steps <- hourly_steps %>%
  distinct() %>%
  drop_na()

```

#### Verifying Duplicates

Verifying that duplicates are successfuly removed.

```{r}
sum(duplicated(daily_sleep))
```

#### Renaming Columns
We are changing the column names to lowercase since its important for data merging. We will check for naming convention too.


```{r}
clean_names(daily_activity)
daily_activity<- rename_with(daily_activity, tolower)
clean_names(hourly_steps)
hourly_steps <- rename_with(hourly_steps, tolower)
clean_names(daily_sleep)
daily_sleep <- rename_with(daily_sleep, tolower)

```

#### Consistency of date and time columns
Now that we have verified our column names and change them to lower case, we will focus on cleaning date-time format for daily_activity and daily_sleep since we will merge both data frames. Since we can disregard the time on daily_sleep data frame we are using as_date instead as as_datetime


```{r}
daily_activity <- daily_activity %>%
  rename(date = activitydate) %>%
  mutate(date = as_date(date, format = "%m/%d/%Y"))

daily_sleep <- daily_sleep %>%
  rename(date = sleepday) %>%
  mutate(date = as_date(date,format ="%m/%d/%Y %I:%M:%S %p" , tz=Sys.timezone()))
```


We will check our cleaned datasets

```{r}
head(daily_activity)
head(daily_sleep)
```

For our hourly_steps dataset we will convert date string to date-time.

```{r}
hourly_steps<- hourly_steps %>% 
  rename(date_time = activityhour) %>% 
  mutate(date_time = as.POSIXct(date_time,format ="%m/%d/%Y %I:%M:%S %p" , tz=Sys.timezone()))

head(hourly_steps)
```


#### Merging Data sets 
We will merge daily_activity and daily_sleep to see any correlation between variables by using id and date as their primary keys.
```{r}

```

```{r}
daily_activity_sleep <- merge(daily_activity, daily_sleep, by=c ("id", "date"))
glimpse(daily_activity_sleep)
```

## Phase 5 : Analyze & Share Data Vizualization

We will analyze the data and extract insights which will help us in the marketing campaign of Bellabeat.    

### Categorizing users of Fitbit

Classification has been made per the following article https://www.10000steps.org.au/articles/counting-steps/

* Very active - More than 10000 steps a day.
* Fairly active - Between 7500 and 9999 steps a day.
* Lightly active - Between 5000 and 7499 steps a day.
* Sedentary - Less than 5000 steps a day.


```{r}
average_steps_calories_sleep <- daily_activity_sleep %>%
  group_by(id) %>%
  summarise (mean_daily_steps = mean(totalsteps), mean_daily_calories = mean(calories), mean_daily_sleep = mean(totalminutesasleep))

head(average_steps_calories_sleep)
```

```{r}
user_type <- average_steps_calories_sleep %>%
  mutate(user_type = case_when(
    mean_daily_steps < 5000 ~ "sedentary",
    mean_daily_steps >= 5000 & mean_daily_steps < 7499 ~ "lightly active", 
    mean_daily_steps >= 7500 & mean_daily_steps < 9999 ~ "fairly active", 
    mean_daily_steps >= 10000 ~ "very active"
  ))

head(user_type)
```

We have the user_type column with this we will create a data frame with the percentage of each user type to better visualize them on a graph.



```{r}
user_type_percent <- user_type %>% 
  group_by(user_type) %>%
  summarise(total=n()) %>%    # n() counts the total no. of observartions for user_type as a group.
  mutate(totals = sum(total)) %>%    # Adding another column to sum up the totals
  group_by(user_type) %>%
  summarise(total_percent = total / totals) %>% #Calculating percentage 
  mutate(percentage = scales::percent(total_percent)) # Converting to percentage.
  
  head(user_type_percent)

```

Plotting User type Distribution with Pie Chart

```{r}

user_type_percent %>% 
  ggplot(aes(x="",y=total_percent, fill=user_type)) +
    geom_bar(stat = "identity", width = 1)+
    coord_polar("y", start=0)+     # code for converting bar chart to pie chart.
    theme_minimal()+
    theme(axis.title.x= element_blank(),
          axis.title.y = element_blank(),
          panel.border = element_blank(), 
          panel.grid = element_blank(), 
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          plot.title = element_text(hjust = 0.5, size=14, face = "bold")) +
    scale_fill_manual(values = c("#3771A1","#F2C6C0", "#FAF1F1", "#B6B5BA")) +
    geom_text(aes(label = percentage),
              position = position_stack(vjust = 0.5))+
    labs(title="User type distribution")

```
Analyzing daily steps and sleep in a week.

### Steps and minutes asleep per weekday
We want to know now what days of the week are the users more active and also what days of the week users sleep more. We will also verify if the users walk the recommended amount of steps and have the recommended amount of sleep.

Below we are calculating the weekdays based on our column date. We are also calculating the average steps walked and minutes sleeped by weekday.

```{r}
 daily_sleep_steps <- daily_activity_sleep %>% 
   mutate(weekday = weekdays(date))    # Weekdays () extracts day names from the date.

 daily_sleep_steps$weekday <-  ordered( daily_sleep_steps$weekday , levels=c("Monday", "Tuesday", "Wednesday", "Thursday", 
                                                                             "Friday", "Saturday", "Sunday")) # this will order the weekdays
 daily_sleep_steps <-  daily_sleep_steps %>% 
   group_by(weekday) %>% 
   summarize(daily_steps=mean(totalsteps), daily_sleep = mean(totalminutesasleep)) 
 
  
  head(daily_sleep_steps)
```



Plotting the above 

```{r}
ggarrange(
    ggplot(daily_sleep_steps) +
      geom_col(aes(weekday, daily_steps), fill = "#006699") +
      geom_hline(yintercept = 7500) +
      labs(title = "Daily steps per weekday", x= "", y = "") +
      theme(axis.text.x = element_text(angle = 45,vjust = 0.5, hjust = 1)),
    ggplot(daily_sleep_steps, aes(weekday, daily_sleep)) +
      geom_col(fill = "#85e0e0") +
      geom_hline(yintercept = 480) +
      labs(title = "Minutes asleep per weekday", x= "", y = "") +
      theme(axis.text.x = element_text(angle = 45,vjust = 0.5, hjust = 1))
  )
```
### Hourly steps throughout the day
Calculating hourly steps throughout the day

```{r}
 hourly_steps <- hourly_steps %>%
    separate(date_time, into = c("date", "time"), sep= " ") %>%
    mutate(date = ymd(date)) 
  
  head(hourly_steps)
```


Plotting the hourly steps per day graph

```{r}
hourly_steps %>%
    group_by(time) %>%
    summarize(average_steps = mean(steptotal)) %>%
    ggplot() +
    geom_col(mapping = aes(x=time, y = average_steps, fill = average_steps)) + 
    labs(title = "Hourly steps throughout the day", x="", y="") + 
    scale_fill_gradient(low = "green", high = "red")+
    theme(axis.text.x = element_text(angle = 90))
```
### Checking Correlations
Finding if there is any corelation between the 2 

```{r}
ggarrange(
    ggplot(daily_activity_sleep, aes(x=totalsteps, y=totalminutesasleep))+
      geom_jitter() +
      geom_smooth(color = "red") + 
      labs(title = "Daily steps vs Minutes asleep", x = "Daily steps", y= "Minutes asleep") +
      theme(panel.background = element_blank(),
            plot.title = element_text( size=14)), 
    ggplot(daily_activity_sleep, aes(x=totalsteps, y=calories))+
      geom_jitter() +
      geom_smooth(color = "red") + 
      labs(title = "Daily steps vs Calories", x = "Daily steps", y= "Calories") +
      theme(panel.background = element_blank(),
            plot.title = element_text( size=14))
  )
```

The 2nd graph Between Daily steps and calories burned has a corelation


We will calculate the number of users that use their smart device on a daily basis, classifying our sample into three categories knowing that the date interval is 31 days
  



```{r}
daily_use <- daily_activity_sleep %>%
    group_by(id) %>%
    summarize(days_used=sum(n())) %>%
    mutate(usage = case_when(
      days_used >= 1 & days_used <= 10 ~ "low use",
      days_used >= 11 & days_used <= 20 ~ "moderate use", 
      days_used >= 21 & days_used <= 31 ~ "high use", 
    ))
  
  head(daily_use)
```


Calculating Percentage of usage


```{r}

daily_use_percent <- daily_use %>%
    group_by(usage) %>%
    summarise(total = n()) %>%
    mutate(totals = sum(total)) %>%
    group_by(usage) %>%
    summarise(total_percent = total / totals) %>%
    mutate(labels = scales::percent(total_percent))
  
  
  head(daily_use_percent)

```


## Use of smart device

### Days used smart device 
Now that we have seen some trends in activity, sleep and calories burned, we want to see how often do the users in our sample use their device. That way we can plan our marketing strategy and see what features would benefit the use of smart devices.

We will calculate the number of users that use their smart device on a daily basis, classifying our sample into three categories knowing that the date interval is 31 days:
*high use - users who use their device between 21 and 31 days.
*moderate use - users who use their device between 10 and 20 days.
*low use - users who use their device between 1 and 10 days.

First we will create a new data frame grouping by Id, calculating number of days used and creating a new column with the classification explained above.

```{r}

 daily_use <- daily_activity_sleep %>%
    group_by(id) %>%
    summarize(days_used=sum(n())) %>%
    mutate(usage = case_when(
      days_used >= 1 & days_used <= 10 ~ "low use",
      days_used >= 11 & days_used <= 20 ~ "moderate use", 
      days_used >= 21 & days_used <= 31 ~ "high use", 
    ))
  
  head(daily_use)
```
Calculating Percentage of usage

```{r}
daily_use_percent <- daily_use %>%
    group_by(usage) %>%
    summarise(total = n()) %>%
    mutate(totals = sum(total)) %>%
    group_by(usage) %>%
    summarise(total_percent = total / totals) %>%
    mutate(labels = scales::percent(total_percent))
  
  
  head(daily_use_percent)
  
```

Plotting the graph for Daily Usage

```{r}
daily_use_percent %>%
    ggplot(aes(x="",y=total_percent, fill=usage)) +
    geom_bar(stat = "identity", width = 1)+
    coord_polar("y", start=0)+
    theme_minimal()+
    theme(axis.title.x= element_blank(),
          axis.title.y = element_blank(),
          panel.border = element_blank(), 
          panel.grid = element_blank(), 
          axis.ticks = element_blank(),
          axis.text.x = element_blank(),
          plot.title = element_text(hjust = 0.5, size=14, face = "bold")) +
    geom_text(aes(label = labels),
              position = position_stack(vjust = 0.5))+
    scale_fill_manual(values = c("#115f9a","#1984c5","#22a7f0"),
                      labels = c("High use - 21 to 31 days",
                                 "Moderate use - 11 to 20 days",
                                 "Low use - 1 to 10 days"))+
    labs(title="Daily use of smart device")
```

### Time used smart device 
Being more precise we want to see how many minutes do users wear their device per day. For that we will merge the created daily_use data frame and daily_activity to be able to filter results by daily use of device as well.



```{r}
daily_use_merged <- merge(daily_activity, daily_use, by=c ("id"))
  head(daily_use_merged)
  
  minutes_worn <- daily_use_merged %>% 
    mutate(total_minutes_worn = veryactiveminutes+fairlyactiveminutes+lightlyactiveminutes+sedentaryminutes)%>%
    mutate (percent_minutes_worn = (total_minutes_worn/1440)*100) %>%
    mutate (worn = case_when(
      percent_minutes_worn == 100 ~ "All day",
      percent_minutes_worn < 100 & percent_minutes_worn >= 50~ "More than half day", 
      percent_minutes_worn < 50 & percent_minutes_worn > 0 ~ "Less than half day"
    ))
  
  head(minutes_worn)

```




```{r}

  minutes_worn_percent<- minutes_worn%>%
    group_by(worn) %>%
    summarise(total = n()) %>%
    mutate(totals = sum(total)) %>%
    group_by(worn) %>%
    summarise(total_percent = total / totals) %>%
    mutate(labels = scales::percent(total_percent))
  
  
  minutes_worn_highuse <- minutes_worn%>%
    filter (usage == "high use")%>%
    group_by(worn) %>%
    summarise(total = n()) %>%
    mutate(totals = sum(total)) %>%
    group_by(worn) %>%
    summarise(total_percent = total / totals) %>%
    mutate(labels = scales::percent(total_percent))
  
  minutes_worn_moduse <- minutes_worn%>%
    filter(usage == "moderate use") %>%
    group_by(worn) %>%
    summarise(total = n()) %>%
    mutate(totals = sum(total)) %>%
    group_by(worn) %>%
    summarise(total_percent = total / totals) %>%
    mutate(labels = scales::percent(total_percent))
  
  minutes_worn_lowuse <- minutes_worn%>%
    filter (usage == "low use") %>%
    group_by(worn) %>%
    summarise(total = n()) %>%
    mutate(totals = sum(total)) %>%
    group_by(worn) %>%
    summarise(total_percent = total / totals) %>%
    mutate(labels = scales::percent(total_percent))
  
  minutes_worn_highuse$worn <- factor(minutes_worn_highuse$worn, levels = c("All day", "More than half day", "Less than half day"))
  minutes_worn_percent$worn <- factor(minutes_worn_percent$worn, levels = c("All day", "More than half day", "Less than half day"))
  minutes_worn_moduse$worn <- factor(minutes_worn_moduse$worn, levels = c("All day", "More than half day", "Less than half day"))
  minutes_worn_lowuse$worn <- factor(minutes_worn_lowuse$worn, levels = c("All day", "More than half day", "Less than half day"))
  
  head(minutes_worn_percent)
  head(minutes_worn_highuse)
  head(minutes_worn_moduse)
  head(minutes_worn_lowuse)
  
```

Plotting a pie graph of Time Usage



```{r}
ggarrange(
    ggplot(minutes_worn_percent, aes(x="",y=total_percent, fill=worn)) +
      geom_bar(stat = "identity", width = 1)+
      coord_polar("y", start=0)+
      theme_minimal()+
      theme(axis.title.x= element_blank(),
            axis.title.y = element_blank(),
            panel.border = element_blank(), 
            panel.grid = element_blank(), 
            axis.ticks = element_blank(),
            axis.text.x = element_blank(),
            plot.title = element_text(hjust = 0.5, size=14, face = "bold"),
            plot.subtitle = element_text(hjust = 0.5)) +
      scale_fill_manual(values = c("#466964", "#599e94", "#6cd4c5"))+
      geom_text(aes(label = labels),
                position = position_stack(vjust = 0.5), size = 3.5)+
      labs(title="Time worn per day", subtitle = "Total Users"),
    ggarrange(
      ggplot(minutes_worn_highuse, aes(x="",y=total_percent, fill=worn)) +
        geom_bar(stat = "identity", width = 1)+
        coord_polar("y", start=0)+
        theme_minimal()+
        theme(axis.title.x= element_blank(),
              axis.title.y = element_blank(),
              panel.border = element_blank(), 
              panel.grid = element_blank(), 
              axis.ticks = element_blank(),
              axis.text.x = element_blank(),
              plot.title = element_text(hjust = 0.5, size=14, face = "bold"),
              plot.subtitle = element_text(hjust = 0.5), 
              legend.position = "none")+
        scale_fill_manual(values = c("#466964", "#599e94", "#6cd4c5"))+
        geom_text_repel(aes(label = labels),
                        position = position_stack(vjust = 0.5), size = 3)+
        labs(title="", subtitle = "High use - Users"), 
      ggplot(minutes_worn_moduse, aes(x="",y=total_percent, fill=worn)) +
        geom_bar(stat = "identity", width = 1)+
        coord_polar("y", start=0)+
        theme_minimal()+
        theme(axis.title.x= element_blank(),
              axis.title.y = element_blank(),
              panel.border = element_blank(), 
              panel.grid = element_blank(), 
              axis.ticks = element_blank(),
              axis.text.x = element_blank(),
              plot.title = element_text(hjust = 0.5, size=14, face = "bold"), 
              plot.subtitle = element_text(hjust = 0.5),
              legend.position = "none") +
        scale_fill_manual(values = c("#466964", "#599e94", "#6cd4c5"))+
        geom_text(aes(label = labels),
                  position = position_stack(vjust = 0.5), size = 3)+
        labs(title="", subtitle = "Moderate use - Users"), 
      ggplot(minutes_worn_lowuse, aes(x="",y=total_percent, fill=worn)) +
        geom_bar(stat = "identity", width = 1)+
        coord_polar("y", start=0)+
        theme_minimal()+
        theme(axis.title.x= element_blank(),
              axis.title.y = element_blank(),
              panel.border = element_blank(), 
              panel.grid = element_blank(), 
              axis.ticks = element_blank(),
              axis.text.x = element_blank(),
              plot.title = element_text(hjust = 0.5, size=14, face = "bold"), 
              plot.subtitle = element_text(hjust = 0.5),
              legend.position = "none") +
        scale_fill_manual(values = c("#466964", "#599e94", "#6cd4c5"))+
        geom_text(aes(label = labels),
                  position = position_stack(vjust = 0.5), size = 3)+
        labs(title="", subtitle = "Low use - Users"), 
      ncol = 3), 
    nrow = 2)
```

36% of the users wear the device all the day. 60% more than half a day and 4% less than half a day .
Diving further we came to know that:
 *6.8% high users who uses the device between 21 and 31 days wear it all day. 89% wears it more than half day     while 4.3% wears it less than half day. 
 * 27% Moderate users who uses the device between 10 and 20 days wear it all day. 69% wears it more than half     day while 4% wears it less than half day.
 *80% low users who uses the device between 1 and 10 days wear it all day. 18% wears it more than half      day while 2% wears it less than half day.

## Phase 5 : Conclusion and Act.

Bellabeat's mission is to empower women by providing them with the data regarding their health.

After deep analysis I would recommend to add more data for further analysis.. Some of the data sets were too small to be taken as a sample . The data sets didnt provide descriptive metadata regarding Demographics and inclusivity.

After our deep analysis we have found different trends which will help the marketing team of bellabeat app.


```{r echo=FALSE}




data <- data.frame(
  Recommendation = c("Recommended step count reminder", "Recommended sleep time reminder", "Rewards"),
  Description = c("Upon Classification we founded that  that the average of users walk more than 7,500 steps daily besides Sundays.so what the marketing team can do is to put a reminder to those customers who are unable to reach the recommended step count with a follow up message about how its beneficial to achieve your daily recommended goals. The correlation between Step count and calories burned was positive." , 
          "Our findings indicate that individuals are getting fewer than eight hours of sleep per day. To address this, users could establish a preferred bedtime and receive a timely notification beforehand, prompting them to prepare for sleep. Additionally, we can provide valuable resources to aid in improving sleep quality, such as breathing exercises, podcasts featuring soothing music, and various techniques proven to enhance sleep.",
          "Recognizing that notifications may not always be effective motivators for everyone, we propose the development of a gamified feature within our app for a specified duration. This game would revolve around achieving various levels based on daily step counts. Users would need to sustain their activity levels over a set period, perhaps a month, to progress to the next tier. As an incentive, participants would earn stars for each level completed, which could be exchanged for merchandise or discounts on other Bellabeat products."
          
          ))


knitr::kable(data, format = "html", caption = "Recommendations") %>%
  kableExtra::kable_styling(full_width = FALSE)

```
---

Thank you !







